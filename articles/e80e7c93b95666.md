---
title: "Rust vs. Go: Merging Multiple Endpoints in Rust REST APIs"
emoji: "ğŸ¤–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: []
published: false
---
Rust åˆå¿ƒè€…ã¨ã—ã¦ã€Production ç”¨ã®ãƒ•ã‚©ãƒ«ãƒ€ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹æˆã‚’è€ƒãˆã‚‹ã€‚

ã“ã‚Œã‚’æ›¸ã„ã¦ã„ã‚‹æ™‚ç‚¹ã®èª²é¡Œã¯ã€æ§‹é€ ä½“ã‚„ handler ã‚’åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ†ã‘ãŸå ´åˆã®å‚ç…§æ–¹æ³•ã€‚

microservices ã‚’å®Ÿè£…ã™ã‚‹ã«ã¯ã€åˆ†å‰²ãŒå¿…è¦ã€‚`main.rs` ã¯ entorypoint ã¨ã—ã¦ã€controller ã‚„ routesã€service ãªã©ã«åˆ†ã‘ã‚‹ã€‚

ãã‚Œã¨ã€Rust ã®ãƒ†ã‚¹ãƒˆæ‰‹æ³•ã€‚

pool ã‚„ client ã‚’æŠ½è±¡åŒ–ã—ã¦ã€test code ã‚’å®Ÿè£…ã§ãã‚‹å½¢ã«å¤‰ãˆã‚‹ã€‚ä¾å­˜é–¢ä¿‚ã®é€†è»¢ã‚’å–ã‚Šå…¥ã‚Œã‚‹ã€‚

LeetCode ã® Graph, BFS, DFS ã‚’è¦‹ã¦ã„ã‚‹ã¨ã€algorithm ã«ç‰¹åŒ–ã—ãŸå­¦ç¿’ãŒå¿…è¦ã‹ã‚‚ã—ã‚Œãªã„ã€‚

ã€ŒRust ã§ãã¾ã™ã€ã¨è¨€ãˆã‚‹ã¾ã§ã«ã¯ã‚‚ã†å°‘ã—æ™‚é–“ãŒã‹ã‹ã‚Šãã†ã€‚

## How to write tests
ãƒ†ã‚¹ãƒˆã®æ›¸ãæ–¹ã«ã¤ã„ã¦ã€‚

Unit tests ã¨ Integration tests ã® 2ã¤ã‚ã‚‹ã€‚

### Unit tests
logic å†…ã«æ›¸ãã€‚
test code ã§ã‚ã‚‹ã“ã¨ã‚’æ˜ç¤ºã™ã‚‹ãŸã‚ã«ã€annotation ã‚’ä»˜ä¸ã™ã‚‹ã€‚

> Unit Tests
The purpose of unit tests is to test each unit of code in isolation from the rest of the code to quickly pinpoint where code is and isnâ€™t working as expected. Youâ€™ll put unit tests in the src directory in each file with the code that theyâ€™re testing. The convention is to create a module named tests in each file to contain the test functions and to annotate the module with cfg(test).

https://doc.rust-lang.org/book/ch11-03-test-organization.html?highlight=cfg(test)#unit-tests

å…¬å¼ã® docs ã®é€šã‚Šã€`cfg(test)` ã‚’ä»˜ä¸ã™ã‚‹ã®ãŒæ…£ä¾‹ã¨ã„ã†ã“ã¨ã€‚

è©¦ã—ã« unit tests ã‚’æ›¸ãã€‚

```rust:routes.rs
#[cfg(test)]
mod tests {
    use super::*;

    #[tokio::test]
    async fn test_api_response_users() {
        let user = User {
            user_id: 9999,
            email_address: Some("hoge@example.com".to_string()),
            created_at: Some(0),
            deleted: Some(0),
            settings: Some("option".to_string()),
        };
        let response = ApiResponse::UserResponse(Some(user)).into_response();
        assert_eq!(response.status(), StatusCode::OK);
    }
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹
```bash
vscode âœ /workspaces/rust-api-samples/main (main) $ cargo test
    Finished test [unoptimized + debuginfo] target(s) in 2.66s
     Running unittests src/main.rs (target/debug/deps/main-794ccb24f64c7f92)

running 1 test
test routes::tests::test_api_response_users ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

vscode âœ /workspaces/rust-api-samples/main (main) $ 
```

VS Code ã®ç”»é¢ã‹ã‚‰ã¡ã‚‡ã£ã›ã¤å®Ÿè¡Œã§ãã‚‹ã€‚
![unit test](image.png)

## Rust Web Server
å®Ÿè£…ã®æ‰‹é †
1. 

## Rust to Go Conversion
å®Ÿè£…ã®æ‰‹é †
1. 
